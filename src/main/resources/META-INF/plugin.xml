<?xml version="1.0" encoding="utf-8"?>

<idea-plugin>
	<vendor url="https://www.github.com/xdev-software">xdev-software</vendor>

	<description><![CDATA[
<p>Provides code analysis and highlighting with <a href="https://pmd.github.io">PMD</a> - an extensible cross-language static code analyzer.</p>
<p>The plugin is optimized for real-time analysis and zero configuration project setups that just require you to checkout the code.</p>
<p>Various other features like bulk analysis are also available for use.</p>
<br/>
<p>More information is available on <a href="https://github.com/xdev-software/intellij-plugin-pmd">GitHub</a>.</p>
<p><sub>Disclaimer: This is not an official PMD project and not associated</sub></p>
    ]]></description>

	<change-notes><![CDATA[
<a href="https://github.com/xdev-software/intellij-plugin-pmd/releases">https://github.com/xdev-software/intellij-plugin-pmd/releases</a>
    ]]>
	</change-notes>

	<depends>com.intellij.modules.platform</depends>
	<depends optional="true" config-file="plugin-java.xml">com.intellij.modules.java</depends>
	<depends optional="true" config-file="plugin-kotlin.xml">org.jetbrains.kotlin</depends>

	<extensions defaultExtensionNs="com.intellij">
		<projectService serviceImplementation="software.xdev.pmd.analysis.PMDAnalyzer"/>
		<projectService serviceImplementation="software.xdev.pmd.model.config.ConfigurationLocationFactory"/>
		<projectService serviceImplementation="software.xdev.pmd.config.ConfigurationLocationSource"/>
		<projectService serviceImplementation="software.xdev.pmd.config.PluginConfigurationManager"/>
		<projectService serviceImplementation="software.xdev.pmd.currentfile.CurrentFileAnalysisManager"/>
		<projectService serviceImplementation="software.xdev.pmd.config.state.project.ProjectConfigurationState"/>
		<projectService serviceImplementation="software.xdev.pmd.markdown.RuleDescriptionDocMarkdownToHtmlService"/>
		<projectService serviceImplementation="software.xdev.pmd.ui.toolwindow.analysis.report.ReportViewManager"/>
		<projectService serviceImplementation="software.xdev.pmd.util.io.ProjectFilePaths"/>
		<projectService serviceImplementation="software.xdev.pmd.util.pmd.PMDLanguageFileTypeMapper"/>

		<postStartupActivity implementation="software.xdev.pmd.startup.PMDStartupConfiguration"/>

		<projectConfigurable instance="software.xdev.pmd.ui.config.project.PMDConfigurable"
							 parentId="tools"
							 displayName="PMD"/>

		<moduleConfigurationEditorProvider
				implementation="software.xdev.pmd.ui.config.module.PMDModuleConfigurationEditorProvider"/>

		<moduleService serviceImplementation="software.xdev.pmd.config.state.module.ModuleConfigurationState"/>

		<toolWindow id="PMD"
					anchor="bottom"
					canCloseContents="true"
					factoryClass="software.xdev.pmd.ui.toolwindow.PMDToolWindowFactory"
					icon="/icons/pmd.svg"/>

		<notificationGroup id="PMDBalloonGroup"
						   displayType="BALLOON"/>
		<notificationGroup id="PMDLogOnlyGroup"
						   displayType="NONE"/>

		<externalAnnotator
				language="JAVA"
				implementationClass="software.xdev.pmd.annotator.PMDExternalLanguageAnnotator"/>
		<externalAnnotator
				language="kotlin"
				implementationClass="software.xdev.pmd.annotator.PMDExternalLanguageAnnotator"/>

		<applicationService serviceImplementation="software.xdev.pmd.action.ActionFilesAnalyzer"/>
		<applicationService serviceImplementation="software.xdev.pmd.langversion.LanguageVersionResolverService"/>
	</extensions>

	<actions>
		<group id="PMDProjectViewGroup"
			   text="PMD"
			   popup="true"
			   icon="/icons/pmd.svg">
			<add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>

			<action class="software.xdev.pmd.action.RunAnalysisAction"
					text="Run Analysis"
					icon="AllIcons.Actions.Find"/>
		</group>
	</actions>

	<!-- Not detected when inside plugin-kotlin.xml -->
	<extensions defaultExtensionNs="org.jetbrains.kotlin">
		<supportsKotlinPluginMode supportsK2="true"/>
	</extensions>
	<extensionPoints>
		<extensionPoint
				name="languageResolver"
				interface="software.xdev.pmd.langversion.LanguageResolver"
				dynamic="true"/>
		<extensionPoint
				name="languageVersionResolver"
				interface="software.xdev.pmd.langversion.LanguageVersionResolver"
				dynamic="true"/>
	</extensionPoints>
</idea-plugin>
